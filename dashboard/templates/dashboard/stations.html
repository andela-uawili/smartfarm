{% extends '_base.html' %}
{% load static %}

{% block title %}Station{% endblock title %}

{% block main %}
  {% for station in stations %}
    <div class="card">

      <div class="header">
        <h2 class="title">Station</h2>
        <h3 class="subtitle">{{ station.name }}</h3>
      </div>

      <div class="content">

        <div class="section sensor-controls">
          <div class="graphic">
            <svg class="icon"><use xlink:href="#icon-humidity"></use></svg>
          </div>
          <div class="controls">
            <h3 class="title">Soil Humidity</h3>
            <span class="value">
              {% if station.current_humidity %}
                {{ station.current_humidity }}%
              {% else %}
                ---
              {% endif %}
            </span>
            <span class="details">Min: {{ station.min_humidity }}% - Max: {{ station.max_humidity }}%</span>
          </div>
        </div>

        <div class="section sprinkler-controls">
          <div class="graphic">
            <svg class="icon"><use xlink:href="#icon-sprinkler"></use></svg>
          </div>
          <div class="controls">
            <h3 class="title">Sprinkler</h3>
            <span class="value">{{ station.sprinkler_status }}%</span>
            <span class="details">
              <ul class="mode-selector-tabs">
                {% for mode in station.SPRINKLER_MODES %}
                  <li class="mode-tab" data-mode-value="{{ mode.0 }}">{{ mode.1 }}</li>
                {% endfor %}
              </ul>
            </span>
          </div>
        </div>

        <div class="options">
          <button class="btn btn-toggle{% if station.is_active %} active{% endif %}">
            <span class="toggle-switch"></span>
            <span class="caption">{% if station.is_active %}Active{% else %}Inactive{% endif %}</span>
          </button>
          <a class="btn btn-option" href="{% url 'dashboard:station_settings' pk=station.pk %}">Settings</a>
        </div>

      </div>

    </div>

  {% empty %}
    <div class="welcome-msg">
      <p>Welcome to the control dashboard for Smartfarm - your IOT-based Smart Irrigation System.<br>
        Setting up your station is easy! Follow the link below to get started!</p>
      <a class="btn btn-primary" href="{% url 'dashboard:station_setup' %}">Setup Station</a>
    </div>
  {% endfor %}

{% endblock main %}